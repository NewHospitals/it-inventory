<!doctype html>
<html lang="ka">
<head>
    <meta charset="UTF-8">
    <title>ინვენტარის სია</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
</head>
<body class="bg-light">
<div class="container py-4">
    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2>მოგესალმები, {{ name }}!</h2>
        <div>
            <a href="{{ url_for('add') }}" class="btn btn-success btn-sm">+ ახალი ინვენტარი</a>
            <a href="{{ url_for('logout') }}" class="btn btn-outline-secondary btn-sm">გასვლა</a>
        </div>
    </div>
    <!-- ძებნის ფორმა -->
    <form method="POST" class="row g-2 mb-3">
        <div class="col">
            <select class="form-select" name="search_type">
                <option value="">ყველა სახეობა</option>
                {% for t in types %}
                <option value="{{ t }}" {% if filters.search_type==t %}selected{% endif %}>{{ t }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col">
            <select class="form-select" name="search_manufacturer">
                <option value="">ყველა ბრენდი</option>
                {% for m in manufacturers %}
                <option value="{{ m }}" {% if filters.search_manufacturer==m %}selected{% endif %}>{{ m }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col">
            <select class="form-select" name="search_status">
                <option value="">ყველა სტატუსი</option>
                {% for s in status_choices %}
                <option value="{{ s }}" {% if filters.search_status==s %}selected{% endif %}>{{ s }}</option>
                {% endfor %}
            </select>
        </div>
        <div class="col">
            <input class="form-control" name="search_owner" placeholder="მფლობელი" value="{{ filters.search_owner or '' }}">
        </div>
        <div class="col">
            <input class="form-control" name="search_serial" placeholder="სერიული" value="{{ filters.search_serial or '' }}">
        </div>
        <div class="col">
            <button type="submit" class="btn btn-primary">ძებნა</button>
        </div>
    </form>
    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <div class="alert alert-success">
        {% for message in messages %}
          <div>{{ message }}</div>
        {% endfor %}
        </div>
      {% endif %}
    {% endwith %}
    <div class="table-responsive">
    <table class="table table-striped table-bordered align-middle">
        <thead class="table-dark">
        <tr>
            <th>ინვ. #</th>
            <th>სახეობა</th>
            <th>მწარმოებელი</th>
            <th>მოდელი</th>
            <th>სერიული</th>
            <th>სტატუსი</th>
            <th>მფლობელი</th>
            <th>მდებარეობა</th>
            <th>დამატებულია/by</th>
            <th>ბოლო ცვლილება</th>
            <th>ქმედება</th>
        </tr>
        </thead>
        <tbody>
        {% for item in items %}
        <tr>
            <td>{{ item.inv_number }}</td>
            <td>{{ item.type }}</td>
            <td>{{ item.manufacturer }}</td>
            <td>{{ item.model }}</td>
            <td>{{ item.serial }}</td>
            <td>
                {% if item.status == 'აქტიური' %}
                  <span class="badge bg-success">{{ item.status }}</span>
                {% elif item.status == 'დაზიანებული' %}
                  <span class="badge bg-danger">{{ item.status }}</span>
                {% elif item.status == 'ჩამოწერილი' %}
                  <span class="badge bg-dark">{{ item.status }}</span>
                {% elif item.status == 'რეზერვში' %}
                  <span class="badge bg-warning text-dark">{{ item.status }}</span>
                {% else %}
                  <span class="badge bg-secondary">{{ item.status }}</span>
                {% endif %}
            </td>
            <td>{{ item.owner }}</td>
            <td>{{ item.location }}</td>
            <td>{{ item.added_by }}</td>
            <td>{{ item.last_modified }}</td>
            <td>
                <a href="{{ url_for('edit', item_id=item.id) }}" class="btn btn-warning btn-sm">რედ.</a>
                <a href="{{ url_for('delete', item_id=item.id) }}" class="btn btn-danger btn-sm"
                   onclick="return confirm('დარწმუნებული ხარ წაშლაში?')">წაშლა</a>
            </td>
        </tr>
        {% endfor %}
        </tbody>
    </table>
    </div>
</div>
</body>
</html>
